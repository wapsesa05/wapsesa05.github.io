(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["BridgeTx"],{"071e":function(e,t,o){"use strict";o.r(t);var n=o("7a23");const i=e=>(Object(n["pushScopeId"])("data-v-12922336"),e=e(),Object(n["popScopeId"])(),e),s={class:"bridge-tx-container"},l={class:"status-container"},a={class:"icon-container"},c={key:0,class:"tx-info"},r={class:"tx-info_li"},d={class:"token-container"},m={class:"icon-token-container mr-5"},u=["src"],f={class:"mr-5"},b={class:"tx-info_li"},h={class:"token-container"},v={class:"icon-token-container mr-5"},x=["src"],O={class:"mr-5"},g={class:"tx-info_li"},j={class:"flex items-center"},p={class:"tx-info_li"},k={class:"flex items-center"},I={key:0},T={key:1},y={class:"tx-info_li"},N={class:"flex items-center"},_={class:"iconfont icon-copy ml-5 clickable",style:{color:"#999"}},S={class:"tx-info_li"},B={class:"flex items-center"},E={class:"tx-info_li"},w=i(()=>Object(n["createElementVNode"])("span",null,"Hash",-1)),V=i(()=>Object(n["createElementVNode"])("span",null,null,-1)),A={class:"flex items-center"},C={class:"ml-5"},$={class:"flex items-center"},D=["onClick"],U={class:"iconfont icon-copy ml-5 clickable",style:{color:"#999"}},H={class:"flex items-center justify-center btn-container"};function F(e,t,i,F,z,L){var R,M,J,P,G,q,W,K,Q,X,Y,Z,ee,te,oe,ne,ie,se,le;const ae=Object(n["resolveComponent"])("van-loading"),ce=Object(n["resolveComponent"])("van-icon"),re=Object(n["resolveComponent"])("van-image"),de=Object(n["resolveComponent"])("van-divider"),me=Object(n["resolveComponent"])("van-button"),ue=Object(n["resolveDirective"])("copy");return Object(n["openBlock"])(),Object(n["createElementBlock"])("div",s,[Object(n["createElementVNode"])("div",l,[Object(n["createElementVNode"])("div",a,[["pending","wait_kyc","wait_refund"].includes((null===(R=z.txInfo)||void 0===R?void 0:R.finalStatus)||(null===(M=z.txInfo)||void 0===M||null===(M=M.status)||void 0===M||null===(J=M.toLowerCase)||void 0===J?void 0:J.call(M)))?(Object(n["openBlock"])(),Object(n["createBlock"])(ae,{key:0,size:"0.48rem",type:"spinner",color:"#3F80F7"})):"success"===((null===(P=z.txInfo)||void 0===P?void 0:P.finalStatus)||(null===(G=z.txInfo)||void 0===G||null===(G=G.status)||void 0===G||null===(q=G.toLowerCase)||void 0===q?void 0:q.call(G)))?(Object(n["openBlock"])(),Object(n["createBlock"])(ce,{key:1,name:"success",color:"#12B886",size:"0.48rem"})):(Object(n["openBlock"])(),Object(n["createBlock"])(ce,{key:2,name:"fail",color:"#999999",size:"0.48rem"}))]),Object(n["createElementVNode"])("div",null,Object(n["toDisplayString"])(L.formatStatus((null===(W=z.txInfo)||void 0===W?void 0:W.finalStatus)||(null===(K=z.txInfo)||void 0===K?void 0:K.status))),1)]),z.txInfo.txHash?(Object(n["openBlock"])(),Object(n["createElementBlock"])("ul",c,[Object(n["createElementVNode"])("li",r,[Object(n["createElementVNode"])("div",null,Object(n["toDisplayString"])(e.$t("from")),1),Object(n["createElementVNode"])("div",d,[Object(n["createElementVNode"])("div",m,[Object(n["createVNode"])(re,{round:"",width:"0.4rem",height:"0.4rem","icon-size":"0.4rem","lazy-load":"","show-loading":"",src:z.txInfo.fromTokenUrl||(z.txInfo.from_address_logo_url?e.$f.formatIcon({logo_url:z.txInfo.from_address_logo_url}):"/icon-default.png"),"error-icon":o("aeccf")},null,8,["src","error-icon"]),null!==(Q=z.txInfo)&&void 0!==Q&&Q.fromTokenChain?(Object(n["openBlock"])(),Object(n["createElementBlock"])("img",{key:0,class:"icon-svg icon-network",src:`${e.$store.state.s3BaseUrl}chain/${null!==(X=z.txInfo)&&void 0!==X&&X.isOkx?null===(Y=z.txInfo)||void 0===Y?void 0:Y.fromTokenChain:z.getBridgeChain(null===(Z=z.txInfo)||void 0===Z?void 0:Z.fromTokenChain)}.png`,alt:"",srcset:""},null,8,u)):Object(n["createCommentVNode"])("",!0)]),Object(n["createElementVNode"])("span",f,Object(n["toDisplayString"])(e.$f.formatNumber2(z.txInfo.fromAmount,5)),1),Object(n["createElementVNode"])("span",null,Object(n["toDisplayString"])((null===(ee=z.txInfo)||void 0===ee?void 0:ee.fromTokenSymbol)||""),1)])]),Object(n["createElementVNode"])("li",b,[Object(n["createElementVNode"])("div",null,Object(n["toDisplayString"])(e.$t("to")),1),Object(n["createElementVNode"])("div",h,[Object(n["createElementVNode"])("div",v,[Object(n["createVNode"])(re,{round:"",width:"0.4rem",height:"0.4rem","icon-size":"0.4rem","lazy-load":"","show-loading":"",src:z.txInfo.toTokenUrl||(z.txInfo.to_address_logo_url?e.$f.formatIcon({logo_url:z.txInfo.to_address_logo_url}):"/icon-default.png"),"error-icon":o("aeccf")},null,8,["src","error-icon"]),null!==(te=z.txInfo)&&void 0!==te&&te.toTokenChain?(Object(n["openBlock"])(),Object(n["createElementBlock"])("img",{key:0,class:"icon-svg icon-network",src:`${e.$store.state.s3BaseUrl}chain/${null!==(oe=z.txInfo)&&void 0!==oe&&oe.isOkx?null===(ne=z.txInfo)||void 0===ne?void 0:ne.toTokenChain:z.getBridgeChain(null===(ie=z.txInfo)||void 0===ie?void 0:ie.toTokenChain)}.png`,alt:"",srcset:""},null,8,x)):Object(n["createCommentVNode"])("",!0)]),Object(n["createElementVNode"])("span",O,Object(n["toDisplayString"])(e.$f.formatNumber2(z.txInfo.toTokenAmount,5)),1),Object(n["createElementVNode"])("span",null,Object(n["toDisplayString"])((null===(se=z.txInfo)||void 0===se?void 0:se.toTokenSymbol)||""),1)])]),Object(n["createElementVNode"])("li",g,[Object(n["createElementVNode"])("div",null,Object(n["toDisplayString"])(e.$t("exchangePlatform")),1),Object(n["createElementVNode"])("div",j,[z.txInfo.logoUrl?(Object(n["openBlock"])(),Object(n["createBlock"])(re,{key:0,class:"icon-token mr-5",round:"",width:"0.36rem",height:"0.36rem","lazy-load":"","show-loading":"",src:z.txInfo.logoUrl,"error-icon":o("aeccf")},null,8,["src","error-icon"])):Object(n["createCommentVNode"])("",!0),Object(n["createElementVNode"])("span",null,Object(n["toDisplayString"])(z.txInfo.dexName),1)])]),Object(n["createElementVNode"])("li",p,[Object(n["createElementVNode"])("div",null,Object(n["toDisplayString"])(e.$t("referenceRate")),1),Object(n["createElementVNode"])("div",k,[z.rateType?(Object(n["openBlock"])(),Object(n["createElementBlock"])("span",I,"1 "+Object(n["toDisplayString"])(z.txInfo.fromTokenSymbol)+" = "+Object(n["toDisplayString"])(L.getRate(1))+" "+Object(n["toDisplayString"])(z.txInfo.toTokenSymbol),1)):(Object(n["openBlock"])(),Object(n["createElementBlock"])("span",T,"1 "+Object(n["toDisplayString"])(z.txInfo.toTokenSymbol)+" = "+Object(n["toDisplayString"])(L.getRate(0))+" "+Object(n["toDisplayString"])(z.txInfo.fromTokenSymbol),1)),Object(n["createElementVNode"])("i",{class:"iconfont icon-switch-h ml-5 clickable",style:{color:"#999"},onClick:t[0]||(t[0]=Object(n["withModifiers"])(e=>z.rateType=!z.rateType,["stop"]))})])]),Object(n["createElementVNode"])("li",y,[Object(n["createElementVNode"])("div",null,Object(n["toDisplayString"])(e.$t("receiveAddress1")),1),Object(n["createElementVNode"])("div",N,[Object(n["createElementVNode"])("a",{onClick:t[1]||(t[1]=Object(n["withModifiers"])(e=>{var t,o,n,i;return L.goAddress(null!==(t=z.txInfo)&&void 0!==t&&t.isOkx?null===(o=z.txInfo)||void 0===o?void 0:o.toTokenChain:(null===(n=z.txInfo)||void 0===n?void 0:n.chain)||z.getBridgeChain(null===(i=z.txInfo)||void 0===i?void 0:i.toTokenChain),z.txInfo.receiveAddress)},["stop"])),target:"_blank",class:"flex items-center"},Object(n["toDisplayString"])(z.txInfo.receiveAddress?z.txInfo.receiveAddress.slice(0,6)+"..."+z.txInfo.receiveAddress.slice(-6):""),1),Object(n["withDirectives"])(Object(n["createElementVNode"])("i",_,null,512),[[ue,z.txInfo.receiveAddress]])])]),Object(n["createElementVNode"])("li",S,[Object(n["createElementVNode"])("div",null,Object(n["toDisplayString"])(e.$t("createTime")),1),Object(n["createElementVNode"])("div",B,Object(n["toDisplayString"])(e.$f.formatDate(z.txInfo.createTimeT)),1)]),Object(n["createVNode"])(de),Object(n["createElementVNode"])("li",E,[w,V,z.txInfo.transaction?(Object(n["openBlock"])(),Object(n["createElementBlock"])("a",{key:0,onClick:t[2]||(t[2]=Object(n["withModifiers"])(t=>e.$f.openBrowser(e.$f.formatExplorerUrl(z.txInfo.chain,z.txInfo.transaction,"tx")),["stop"])),target:"_blank",style:{color:"#878fbc"}},Object(n["toDisplayString"])(z.txInfo.transaction?z.txInfo.transaction.slice(0,6)+"..."+z.txInfo.transaction.slice(-6):""),1)):Object(n["createCommentVNode"])("",!0)]),(Object(n["openBlock"])(!0),Object(n["createElementBlock"])(n["Fragment"],null,Object(n["renderList"])((null===(le=z.txInfo)||void 0===le?void 0:le.statusList)||z.txInfo.status||[],(t,o)=>{var i,s;return Object(n["openBlock"])(),Object(n["createElementBlock"])("li",{class:"tx-info_li",key:o},[Object(n["createElementVNode"])("div",A,["pending"===t.status||"wait_kyc"===t.status||"wait_refund"===t.status?(Object(n["openBlock"])(),Object(n["createBlock"])(ae,{key:0,size:"0.4rem",color:"#3F80F7"})):"success"===(null===t||void 0===t||null===(i=t.status)||void 0===i||null===(s=i.toLowerCase)||void 0===s?void 0:s.call(i))?(Object(n["openBlock"])(),Object(n["createBlock"])(ce,{key:1,name:"success",color:"#12B886",size:"0.4rem"})):Object(n["createCommentVNode"])("",!0),Object(n["createElementVNode"])("span",C,Object(n["toDisplayString"])(t.chain),1)]),Object(n["createElementVNode"])("div",$,[Object(n["createElementVNode"])("a",{onClick:Object(n["withModifiers"])(o=>e.$f.openBrowser(t.url),["stop"]),target:"_blank",class:"flex items-center"},Object(n["toDisplayString"])(t.txHash?t.txHash.slice(0,6)+"..."+t.txHash.slice(-6):""),9,D),Object(n["withDirectives"])(Object(n["createElementVNode"])("i",U,null,512),[[ue,t.txHash]])])])}),128))])):Object(n["createCommentVNode"])("",!0),Object(n["createElementVNode"])("div",H,[Object(n["createVNode"])(me,{class:"btn-s",plain:"",round:"",onClick:Object(n["withModifiers"])(L.goBridge,["stop"])},{default:Object(n["withCtx"])(()=>[Object(n["createTextVNode"])(Object(n["toDisplayString"])(e.$t("swapAgain")),1)]),_:1},8,["onClick"])])])}o("14d9");var z=o("901e"),L=o.n(z),R=o("365c"),M=o("2c28"),J=o("8e2e"),P=o("a002"),G=o.n(P),q=o("6779"),W={name:"BridgeTx",setup(){let e=Object(M["useStorage"])("bridge_FromToken",{address:"",chain:"",symbol:""},sessionStorage),t=Object(M["useStorage"])("bridge_toToken",{address:"",chain:"",symbol:""},sessionStorage),o=Object(J["a"])("okxBridgeTxs",[]);return{fromToken:e,toToken:t,okxBridgeTxs:o}},data(){return{getBridgeChain:R["u"],rateType:!0,txInfo:{}}},watch:{"$route.params.hash":{handler(e){e&&this.init()},immediate:!0}},mounted(){},methods:{init(){if("BridgeTx"!==this.$route.name)return;let e=this.$route.params.hash,t="1"===this.$route.query.isOkx;/0x.+-.+-v[1|2]/.test(e)?this.getUserTxDetail():t?this.getOkxBridgeTxStatus():this.getBridgeTransDetail()},getBridgeTransDetail(){let e=this.$route.params.hash;e&&Object(R["z"])(e).then(t=>{console.log(t),this.txInfo=t,["success","refund_complete","fail"].includes(null===t||void 0===t?void 0:t.finalStatus)||setTimeout(()=>{this.getBridgeTransDetail(e)},8e3)}).catch(e=>{console.log(e),this.$toast({position:"top",message:e})})},getUserTxDetail(){let e=this.$route.params.hash,[t,n,i]=e.split("-"),s={transaction:t,chain:n,source_type:i};Object(R["sb"])(s).then(e=>{let t=o("9d64");this.txInfo={...e,createTimeT:1e3*e.time,txHash:e.transaction,fromTokenAddress:e.from_address,fromAmount:e.from_amount,fromTokenSymbol:e.from_symbol,toTokenAddress:e.to_address,toTokenAmount:e.to_amount,toTokenSymbol:e.to_symbol,finalStatus:0===e.is_merged?"pending":"success",receiveAddress:e.wallet_address,logoUrl:t,dexName:"AveSwap"},Object(R["lb"])([e.from_address+"-"+e.chain,e.to_address+"-"+e.chain]).then(e=>{var t,o;this.txInfo.from_address_logo_url=null===e||void 0===e||null===(t=e[0])||void 0===t?void 0:t.logo_url,this.txInfo.to_address_logo_url=null===e||void 0===e||null===(o=e[1])||void 0===o?void 0:o.logo_url})})},async getOkxBridgeTxStatus(){let e=this.$route.params.hash,t=await G.a.getItem("okxBridgeTxs").catch(async()=>[]),o=(t||[]).find(t=>((null===t||void 0===t?void 0:t.txHash)||(null===t||void 0===t?void 0:t.fromTxHash))===e);o&&(this.txInfo={...o,finalStatus:o.status,statusList:[]}),e&&Object(R["U"])({hash:e}).then(e=>{let n=null===e||void 0===e?void 0:e[0];if(n){var i,s;let e=[];if(n.fromTxHash){let t=null===o||void 0===o?void 0:o.fromTokenChain;e.push({status:"WAITING"===(null===n||void 0===n?void 0:n.detailStatus)?"pending":"success",txHash:n.fromTxHash,chain:t,url:this.$f.formatExplorerUrl(t,n.fromTxHash,"tx")})}if(n.toTxHash){let t=null===o||void 0===o?void 0:o.toTokenChain;e.push({status:null===n||void 0===n?void 0:n.status,txHash:n.toTxHash,chain:t,url:this.$f.formatExplorerUrl(t,n.toTxHash,"tx")})}this.txInfo={...o||{},...n,fromAmount:null!==n&&void 0!==n&&n.fromAmount&&"0"!==(null===n||void 0===n?void 0:n.fromAmount)?q["utils"].formatUnits(null===n||void 0===n?void 0:n.fromAmount,o.fromDecimals):null===o||void 0===o?void 0:o.fromAmount,toTokenAmount:n.toAmount&&"0"!==n.toAmount?q["utils"].formatUnits(n.toAmount,o.toDecimals):null===o||void 0===o?void 0:o.toTokenAmount,statusList:e,status:"NOT_FOUND"===n.status&&Date.now()-(null===(i=this.txInfo)||void 0===i?void 0:i.createTimeT)<6e4?"pending":n.status},console.log("txInfo",this.txInfo);let l=t.map(t=>{var o;return t.txHash===n.fromTxHash?{...t,...n,fromAmount:null!==n&&void 0!==n&&n.fromAmount&&"0"!==(null===n||void 0===n?void 0:n.fromAmount)?q["utils"].formatUnits(null===n||void 0===n?void 0:n.fromAmount,t.fromDecimals):null===t||void 0===t?void 0:t.fromAmount,toTokenAmount:n.toAmount&&"0"!==n.toAmount?q["utils"].formatUnits(n.toAmount,t.toDecimals):null===t||void 0===t?void 0:t.toTokenAmount,statusList:e,status:"NOT_FOUND"===n.status&&Date.now()-(null===(o=this.txInfo)||void 0===o?void 0:o.createTimeT)<6e4?"pending":n.status}:t});G.a.setItem("okxBridgeTxs",l),"SUCCESS"===(null===(s=this.txInfo)||void 0===s?void 0:s.status)||"NOT_FOUND"===n.status&&Date.now()-o.createTimeT<6e4||setTimeout(()=>{this.getOkxBridgeTxStatus()},1e4)}}).catch(e=>{console.log(e),this.$toast({position:"top",message:e})})},getRate(e=0){return this.txInfo.fromAmount&&this.txInfo.toTokenAmount?0===e?this.$f.formatNumber2(new L.a(this.txInfo.fromAmount).div(this.txInfo.toTokenAmount).toFixed()):this.$f.formatNumber2(new L.a(this.txInfo.toTokenAmount).div(this.txInfo.fromAmount).toFixed()):"--"},goAddress(e,t){this.$f.openBrowser(this.$f.formatExplorerUrl(e,t,"address"))},formatStatus(e){var t;let o={pending:this.$t("swapPending"),success:this.$t("swapSucceed"),fail:this.$t("swapFailed"),wait_kyc:this.$t("wait_kyc"),wait_refund:this.$t("wait_refund"),refund_complete:this.$t("refund_complete"),timeout:this.$t("timeout"),PENDING:this.$t("pending"),SUCCESS:this.$t("succeed"),FAILURE:this.$t("failed"),REFUND:this.$t("refund")};return null!==(t=o[e])&&void 0!==t?t:e},goBridge(){var e,t;this.fromToken={address:this.txInfo.fromTokenAddress,chain:this.getBridgeChain(null===(e=this.txInfo)||void 0===e?void 0:e.fromTokenChain),bridgeChain:this.txInfo.fromTokenChain,symbol:this.txInfo.fromTokenSymbol,logoURI:this.txInfo.fromTokenUrl},this.toToken={address:this.txInfo.toTokenAddress,chain:this.getBridgeChain(null===(t=this.txInfo)||void 0===t?void 0:t.toTokenChain),bridgeChain:this.txInfo.toTokenChain,symbol:this.txInfo.toTokenSymbol,logoURI:this.txInfo.toTokenUrl},this.$router.push({name:"Bridge"})}}},K=(o("3ff0"),o("6b0d")),Q=o.n(K);const X=Q()(W,[["render",F],["__scopeId","data-v-12922336"]]);t["default"]=X},"3ff0":function(e,t,o){"use strict";o("e82f")},"8e2e":function(e,t,o){"use strict";o.d(t,"a",(function(){return l}));var n=o("a002"),i=o.n(n),s=o("7a23");function l(e,t){let o=Object(s["ref"])(t);function n(){i.a.getItem(e).then(n=>{console.log("read",e,null!==n&&void 0!==n?n:t),null===n?(o.value=t,i.a.setItem(e,t)):o.value=n}).catch(e=>{o.value=v})}function l(t){let n=t||o.value;return n?Array.isArray(n)?i.a.setItem(e,JSON.parse(JSON.stringify(o.value))):void("object"===typeof o.value?i.a.setItem(e,{...n}):i.a.setItem(e,n)):i.a.removeItem(e)}return n(),Object(s["watch"])(o,e=>{l()}),o}},"9d64":function(e,t,o){e.exports=o.p+"static/img/logo.ae1a22fb.png"},aeccf:function(e,t,o){e.exports=o.p+"static/img/icon-default.75f6e9a0.png"},e82f:function(e,t,o){}}]);